import{_ as C,c as x,o as y,A as O,r as G,B as R}from"#entry";const Y={},z={class:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"};function M(e,s){return y(),x("button",z,[O(e.$slots,"default")])}const X=Object.assign(C(Y,[["render",M]]),{__name:"Button"});function T(){return Math.random().toString(36).substring(2,15)}const _="__debug_enabled__";function E(){return window.localStorage.getItem(_)==="true"}function j(){window.localStorage.setItem(_,"true"),console.log("[Debug] Logging enabled")}function J(){window.localStorage.setItem(_,"false"),console.log("[Debug] Logging disabled")}function n(e,...s){E()&&console.log(`[${e}]`,...s)}function L(e,...s){E()&&console.error(`[${e}]`,...s)}window.enableDebug=j,window.disableDebug=J;const A=new Map;function $(e,s){if(n("useLocalStorage",`Called for "${e}"`),A.has(e)){const l=A.get(e);return n("useLocalStorage",`"${e}" returning existing ref, current value length:`,l?.value?.length),l}const g=G(s);A.set(e,g),n("useLocalStorage",`"${e}" created new ref`);const c=window.localStorage.getItem(e);if(n("useLocalStorage",`"${e}" localStorage value:`,c?"EXISTS":"NULL"),c)try{g.value=JSON.parse(c),n("useLocalStorage",`"${e}" loaded value:`,g.value)}catch(l){L("useLocalStorage",`Error parsing "${e}":`,l)}else n("useLocalStorage",`"${e}" using initial value`);return R(g,(l,S)=>{n("useLocalStorage",`"${e}" WATCH triggered!`,{newValue:l,oldValue:S});try{window.localStorage.setItem(e,JSON.stringify(l)),n("useLocalStorage",`"${e}" saved successfully`)}catch(w){L("useLocalStorage",`Error saving "${e}":`,w)}},{deep:!0,immediate:!1}),n("useLocalStorage",`"${e}" watcher set up`),g}const K="students",I="assignmentHistory",U={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};function m(e){const s=e.toLowerCase().match(/(\d+)-\d+\s+de\s+(\w+)/);if(!s||!s[1]||!s[2])return 0;const g=parseInt(s[1]),c=s[2].toLowerCase(),l=U[c];if(l===void 0)return 0;const S=new Date().getFullYear();return new Date(S,l,g).getTime()}let b=null,h=null;function W(){n("useStudents","Initializing global state..."),b||(n("useStudents","Creating globalStudents ref"),b=$(K,[])),h||(n("useStudents","Creating globalAssignmentHistory ref"),h=$(I,[])),n("useStudents","Global state initialized")}function q(){n("useStudents","useStudents() called"),(!b||!h)&&W();const e=b,s=h;n("useStudents","Refs assigned:",{students:!!b,assignmentHistory:!!h});function g(a,r){const o={id:T(),name:a.trim(),gender:r,hidden:!1};return e.value.push(o),o}function c(a){const r=e.value.find(o=>o.id===a);r&&(r.hidden=!r.hidden)}function l(a,r){const o=s.value.filter(t=>(t.studentId===a||t.companionId===a)&&t.assignmentType===r).sort((t,u)=>u.createdAt-t.createdAt);return o.length>0?o[0]?.weekDate??null:null}function S(a,r){const o=s.value.filter(t=>t.studentId===a&&t.companionId===r||t.studentId===r&&t.companionId===a).sort((t,u)=>u.createdAt-t.createdAt);return o.length>0?o[0]?.weekDate??null:null}function w(a,r){return e.value.filter(t=>!t.hidden).map(t=>({...t,lastAssignmentDate:l(t.id,a)})).sort((t,u)=>{if(!t.lastAssignmentDate&&!u.lastAssignmentDate)return 0;if(!t.lastAssignmentDate)return-1;if(!u.lastAssignmentDate)return 1;const p=m(t.lastAssignmentDate),i=m(u.lastAssignmentDate);return p-i})}function H(a,r,o){const t=e.value.find(i=>i.id===a);if(!t)return[];const u=t.gender;return e.value.filter(i=>!i.hidden&&i.id!==a&&i.gender===u).map(i=>({...i,lastTimeTogether:S(a,i.id),lastAssignmentDate:l(i.id,o)})).sort((i,f)=>{let d=0;if(!i.lastTimeTogether&&!f.lastTimeTogether)d=0;else if(!i.lastTimeTogether)d=-1;else if(!f.lastTimeTogether)d=1;else{const D=m(i.lastTimeTogether),v=m(f.lastTimeTogether);d=D-v}if(d===0)if(!i.lastAssignmentDate&&!f.lastAssignmentDate)d=0;else if(!i.lastAssignmentDate)d=-1;else if(!f.lastAssignmentDate)d=1;else{const D=m(i.lastAssignmentDate),v=m(f.lastAssignmentDate);d=D-v}return d})}function N(a){n("useStudents","assignStudent() called:",a),n("useStudents","assignmentHistory ref:",s),n("useStudents","assignmentHistory.value before:",s.value.length);const r={...a,id:T(),createdAt:Date.now()};n("useStudents","Creating new record:",r);const o=[...s.value,r];n("useStudents","New array length:",o.length),s.value=o,n("useStudents","assignmentHistory.value after:",s.value.length),setTimeout(()=>{const t=window.localStorage.getItem(I),u=t?JSON.parse(t):[];n("useStudents","localStorage verification:",u.length,"records")},100)}function B(a){return e.value.find(o=>o.id===a)?.name||""}return{students:e,assignmentHistory:s,addStudent:g,toggleStudentHidden:c,getStudentsSortedByLastAssignment:w,getCompanionsSorted:H,assignStudent:N,getStudentName:B,getLastAssignmentDate:l}}export{X as _,$ as a,q as u};
