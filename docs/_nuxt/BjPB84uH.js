import{_ as B,c as C,o as y,A as x,r as G,B as O}from"#entry";const Y={},z={class:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"};function M(e,n){return y(),C("button",z,[x(e.$slots,"default")])}const X=Object.assign(B(Y,[["render",M]]),{__name:"Button"});function T(){return Math.random().toString(36).substring(2,15)}const v="__debug_enabled__";function E(){return window.localStorage.getItem(v)==="true"}function R(){window.localStorage.setItem(v,"true"),console.log("[Debug] Logging enabled")}function j(){window.localStorage.setItem(v,"false"),console.log("[Debug] Logging disabled")}function s(e,...n){E()&&console.log(`[${e}]`,...n)}function L(e,...n){E()&&console.error(`[${e}]`,...n)}window.enableDebug=R,window.disableDebug=j;const _=new Map;function $(e,n){if(s("useLocalStorage",`Called for "${e}"`),_.has(e))return s("useLocalStorage",`"${e}" returning existing ref`),_.get(e);const d=G(n);_.set(e,d),s("useLocalStorage",`"${e}" created new ref`);const c=window.localStorage.getItem(e);if(s("useLocalStorage",`"${e}" localStorage value:`,c?"EXISTS":"NULL"),c)try{d.value=JSON.parse(c),s("useLocalStorage",`"${e}" loaded value:`,d.value)}catch(l){L("useLocalStorage",`Error parsing "${e}":`,l)}else s("useLocalStorage",`"${e}" using initial value`);return O(d,(l,S)=>{s("useLocalStorage",`"${e}" WATCH triggered!`,{newValue:l,oldValue:S});try{window.localStorage.setItem(e,JSON.stringify(l)),s("useLocalStorage",`"${e}" saved successfully`)}catch(D){L("useLocalStorage",`Error saving "${e}":`,D)}},{deep:!0,immediate:!1}),s("useLocalStorage",`"${e}" watcher set up`),d}const K="students",U="assignmentHistory",J={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};function m(e){const n=e.toLowerCase().match(/(\d+)-\d+\s+de\s+(\w+)/);if(!n||!n[1]||!n[2])return 0;const d=parseInt(n[1]),c=n[2].toLowerCase(),l=J[c];if(l===void 0)return 0;const S=new Date().getFullYear();return new Date(S,l,d).getTime()}let b=null,h=null;function W(){s("useStudents","Initializing global state..."),b||(s("useStudents","Creating globalStudents ref"),b=$(K,[])),h||(s("useStudents","Creating globalAssignmentHistory ref"),h=$(U,[])),s("useStudents","Global state initialized")}function q(){s("useStudents","useStudents() called"),(!b||!h)&&W();const e=b,n=h;s("useStudents","Refs assigned:",{students:!!b,assignmentHistory:!!h});function d(a,r){const o={id:T(),name:a.trim(),gender:r,hidden:!1};return e.value.push(o),o}function c(a){const r=e.value.find(o=>o.id===a);r&&(r.hidden=!r.hidden)}function l(a,r){const o=n.value.filter(t=>(t.studentId===a||t.companionId===a)&&t.assignmentType===r).sort((t,g)=>g.createdAt-t.createdAt);return o.length>0?o[0]?.weekDate??null:null}function S(a,r){const o=n.value.filter(t=>t.studentId===a&&t.companionId===r||t.studentId===r&&t.companionId===a).sort((t,g)=>g.createdAt-t.createdAt);return o.length>0?o[0]?.weekDate??null:null}function D(a,r){return e.value.filter(t=>!t.hidden).map(t=>({...t,lastAssignmentDate:l(t.id,a)})).sort((t,g)=>{if(!t.lastAssignmentDate&&!g.lastAssignmentDate)return 0;if(!t.lastAssignmentDate)return-1;if(!g.lastAssignmentDate)return 1;const p=m(t.lastAssignmentDate),i=m(g.lastAssignmentDate);return p-i})}function H(a,r,o){const t=e.value.find(i=>i.id===a);if(!t)return[];const g=t.gender;return e.value.filter(i=>!i.hidden&&i.id!==a&&i.gender===g).map(i=>({...i,lastTimeTogether:S(a,i.id),lastAssignmentDate:l(i.id,o)})).sort((i,f)=>{let u=0;if(!i.lastTimeTogether&&!f.lastTimeTogether)u=0;else if(!i.lastTimeTogether)u=-1;else if(!f.lastTimeTogether)u=1;else{const w=m(i.lastTimeTogether),A=m(f.lastTimeTogether);u=w-A}if(u===0)if(!i.lastAssignmentDate&&!f.lastAssignmentDate)u=0;else if(!i.lastAssignmentDate)u=-1;else if(!f.lastAssignmentDate)u=1;else{const w=m(i.lastAssignmentDate),A=m(f.lastAssignmentDate);u=w-A}return u})}function I(a){s("useStudents","assignStudent() called:",a),s("useStudents","assignmentHistory ref:",n),s("useStudents","assignmentHistory.value before:",n.value.length);const r={...a,id:T(),createdAt:Date.now()};s("useStudents","Creating new record:",r);const o=[...n.value,r];s("useStudents","New array length:",o.length),n.value=o,s("useStudents","assignmentHistory.value after:",n.value.length)}function N(a){return e.value.find(o=>o.id===a)?.name||""}return{students:e,assignmentHistory:n,addStudent:d,toggleStudentHidden:c,getStudentsSortedByLastAssignment:D,getCompanionsSorted:H,assignStudent:I,getStudentName:N,getLastAssignmentDate:l}}export{X as _,$ as a,q as u};
