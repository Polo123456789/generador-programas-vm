import{_ as C,c as x,o as G,A as M,r as D,B as O,C as Y,D as R}from"#entry";const j={},K={class:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"};function U(t,s){return G(),x("button",K,[M(t.$slots,"default")])}const P=Object.assign(C(j,[["render",U]]),{__name:"Button"});function L(){return Math.random().toString(36).substring(2,15)}const T="__debug_enabled__";function H(){return window.localStorage.getItem(T)==="true"}function k(){window.localStorage.setItem(T,"true"),console.log("[Debug] Logging enabled")}function J(){window.localStorage.setItem(T,"false"),console.log("[Debug] Logging disabled")}function n(t,...s){H()&&console.log(`[${t}]`,...s)}function y(t,...s){H()&&console.error(`[${t}]`,...s)}window.enableDebug=k,window.disableDebug=J;function I(t,s){const r=D(s);n("useLocalStorage",`Initializing "${t}"`);{const g=window.localStorage.getItem(t);if(n("useLocalStorage",`"${t}" localStorage value:`,g?"EXISTS":"NULL"),g)try{r.value=JSON.parse(g),n("useLocalStorage",`"${t}" loaded value:`,r.value)}catch(d){y("useLocalStorage",`Error parsing "${t}":`,d)}else n("useLocalStorage",`"${t}" using initial value`);O(r,(d,m)=>{n("useLocalStorage",`"${t}" WATCH triggered!`,{newValue:d,oldValue:m});try{window.localStorage.setItem(t,JSON.stringify(d)),n("useLocalStorage",`"${t}" saved successfully`)}catch(A){y("useLocalStorage",`Error saving "${t}":`,A)}},{deep:!0,immediate:!1})}return r}const W="students",F="assignmentHistory",X={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};function S(t){const s=t.toLowerCase().match(/(\d+)-\d+\s+de\s+(\w+)/);if(!s||!s[1]||!s[2])return 0;const r=parseInt(s[1]),g=s[2].toLowerCase(),d=X[g];if(d===void 0)return 0;const m=new Date().getFullYear();return new Date(m,d,r).getTime()}let h=null,v=null,b=!1;function E(){n("useStudents","Initializing global state..."),h||(n("useStudents","Creating globalStudents ref"),h=I(W,[])),v||(n("useStudents","Creating globalAssignmentHistory ref"),v=I(F,[])),b=!0,n("useStudents","Global state initialized")}function Q(){const t=D(!1);n("useStudents","useStudents() called, initialized:",b,"client:",!0),Y(()=>{n("useStudents","onMounted triggered"),R(()=>{n("useStudents","nextTick callback, initialized:",b),b||E(),t.value=!0,n("useStudents","Ready state set to true")})}),b||(n("useStudents","Immediate client-side initialization"),E(),t.value=!0);const s=h??D([]),r=v??D([]);n("useStudents","Refs assigned:",{students:!!h,assignmentHistory:!!v});function g(a,l){const i={id:L(),name:a.trim(),gender:l,hidden:!1};return s.value.push(i),i}function d(a){const l=s.value.find(i=>i.id===a);l&&(l.hidden=!l.hidden)}function m(a,l){const i=r.value.filter(e=>(e.studentId===a||e.companionId===a)&&e.assignmentType===l).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function A(a,l){const i=r.value.filter(e=>e.studentId===a&&e.companionId===l||e.studentId===l&&e.companionId===a).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function $(a,l){return s.value.filter(e=>!e.hidden).map(e=>({...e,lastAssignmentDate:m(e.id,a)})).sort((e,c)=>{if(!e.lastAssignmentDate&&!c.lastAssignmentDate)return 0;if(!e.lastAssignmentDate)return-1;if(!c.lastAssignmentDate)return 1;const p=S(e.lastAssignmentDate),o=S(c.lastAssignmentDate);return p-o})}function N(a,l,i){const e=s.value.find(o=>o.id===a);if(!e)return[];const c=e.gender;return s.value.filter(o=>!o.hidden&&o.id!==a&&o.gender===c).map(o=>({...o,lastTimeTogether:A(a,o.id),lastAssignmentDate:m(o.id,i)})).sort((o,f)=>{let u=0;if(!o.lastTimeTogether&&!f.lastTimeTogether)u=0;else if(!o.lastTimeTogether)u=-1;else if(!f.lastTimeTogether)u=1;else{const w=S(o.lastTimeTogether),_=S(f.lastTimeTogether);u=w-_}if(u===0)if(!o.lastAssignmentDate&&!f.lastAssignmentDate)u=0;else if(!o.lastAssignmentDate)u=-1;else if(!f.lastAssignmentDate)u=1;else{const w=S(o.lastAssignmentDate),_=S(f.lastAssignmentDate);u=w-_}return u})}function z(a){n("useStudents","assignStudent() called:",a),n("useStudents","assignmentHistory ref:",r),n("useStudents","assignmentHistory.value before:",r.value.length);const l={...a,id:L(),createdAt:Date.now()};n("useStudents","Creating new record:",l);const i=[...r.value,l];n("useStudents","New array length:",i.length),r.value=i,n("useStudents","assignmentHistory.value after:",r.value.length)}function B(a){return s.value.find(i=>i.id===a)?.name||""}return{students:s,assignmentHistory:r,ready:t,addStudent:g,toggleStudentHidden:d,getStudentsSortedByLastAssignment:$,getCompanionsSorted:N,assignStudent:z,getStudentName:B,getLastAssignmentDate:m}}export{P as _,I as a,Q as u};
