import{_ as E,c as I,o as N,A as $,r as B,B as H}from"#entry";const x={},y={class:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"};function O(t,o){return N(),I("button",y,[$(t.$slots,"default")])}const M=Object.assign(E(x,[["render",O]]),{__name:"Button"});function T(){return Math.random().toString(36).substring(2,15)}function _(t,o){const u=B(o);console.log(`[useLocalStorage:${t}] Inicializando...`);{const d=window.localStorage.getItem(t);if(console.log(`[useLocalStorage:${t}] Valor en localStorage:`,d?"EXISTS":"NULL"),d)try{u.value=JSON.parse(d),console.log(`[useLocalStorage:${t}] Valor cargado:`,u.value)}catch(r){console.error(`[useLocalStorage:${t}] Error parseando:`,r)}else console.log(`[useLocalStorage:${t}] Usando valor inicial`);H(u,r=>{console.log(`[useLocalStorage:${t}] WATCH triggered!`,r);try{window.localStorage.setItem(t,JSON.stringify(r)),console.log(`[useLocalStorage:${t}] Guardado exitoso`)}catch(f){console.error(`[useLocalStorage:${t}] Error guardando:`,f)}},{deep:!0})}return u}const C="students",G="assignmentHistory",Y={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};function m(t){const o=t.toLowerCase().match(/(\d+)-\d+\s+de\s+(\w+)/);if(!o||!o[1]||!o[2])return 0;const u=parseInt(o[1]),d=o[2].toLowerCase(),r=Y[d];if(r===void 0)return 0;const f=new Date().getFullYear();return new Date(f,r,u).getTime()}let A=null,D=null;function j(){A||(A=_(C,[])),D||(D=_(G,[]))}function R(){j();const t=A,o=D;function u(n,a){const i={id:T(),name:n.trim(),gender:a,hidden:!1};return t.value.push(i),i}function d(n){const a=t.value.find(i=>i.id===n);a&&(a.hidden=!a.hidden)}function r(n,a){const i=o.value.filter(e=>(e.studentId===n||e.companionId===n)&&e.assignmentType===a).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function f(n,a){const i=o.value.filter(e=>e.studentId===n&&e.companionId===a||e.studentId===a&&e.companionId===n).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function v(n,a){return t.value.filter(e=>!e.hidden).map(e=>({...e,lastAssignmentDate:r(e.id,n)})).sort((e,c)=>{if(!e.lastAssignmentDate&&!c.lastAssignmentDate)return 0;if(!e.lastAssignmentDate)return-1;if(!c.lastAssignmentDate)return 1;const p=m(e.lastAssignmentDate),s=m(c.lastAssignmentDate);return p-s})}function w(n,a,i){const e=t.value.find(s=>s.id===n);if(!e)return[];const c=e.gender;return t.value.filter(s=>!s.hidden&&s.id!==n&&s.gender===c).map(s=>({...s,lastTimeTogether:f(n,s.id),lastAssignmentDate:r(s.id,i)})).sort((s,g)=>{let l=0;if(!s.lastTimeTogether&&!g.lastTimeTogether)l=0;else if(!s.lastTimeTogether)l=-1;else if(!g.lastTimeTogether)l=1;else{const S=m(s.lastTimeTogether),h=m(g.lastTimeTogether);l=S-h}if(l===0)if(!s.lastAssignmentDate&&!g.lastAssignmentDate)l=0;else if(!s.lastAssignmentDate)l=-1;else if(!g.lastAssignmentDate)l=1;else{const S=m(s.lastAssignmentDate),h=m(g.lastAssignmentDate);l=S-h}return l})}function L(n){console.log("[assignStudent] Iniciando asignación:",n),console.log("[assignStudent] Estado antes:",o.value.length,"registros");const a={...n,id:T(),createdAt:Date.now()};console.log("[assignStudent] Registro completo:",a),o.value=[...o.value,a],console.log("[assignStudent] Estado después:",o.value.length,"registros"),console.log("[assignStudent] assignmentHistory ref:",o)}function b(n){return t.value.find(i=>i.id===n)?.name||""}return{students:t,assignmentHistory:o,addStudent:u,toggleStudentHidden:d,getStudentsSortedByLastAssignment:v,getCompanionsSorted:w,assignStudent:L,getStudentName:b,getLastAssignmentDate:r}}export{M as _,_ as a,R as u};
