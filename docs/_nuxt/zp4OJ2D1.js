import{_ as B,c as C,o as x,A as G,r as v,B as M,C as O,D as Y}from"#entry";const R={},j={class:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"};function K(t,s){return x(),C("button",j,[G(t.$slots,"default")])}const X=Object.assign(B(R,[["render",K]]),{__name:"Button"});function w(){return Math.random().toString(36).substring(2,15)}const U="__debug_enabled__";function H(){return window.localStorage.getItem(U)==="true"}function n(t,...s){H()&&console.log(`[${t}]`,...s)}function L(t,...s){H()&&console.error(`[${t}]`,...s)}function y(t,s){const l=v(s);n("useLocalStorage",`Initializing "${t}"`);{const g=window.localStorage.getItem(t);if(n("useLocalStorage",`"${t}" localStorage value:`,g?"EXISTS":"NULL"),g)try{l.value=JSON.parse(g),n("useLocalStorage",`"${t}" loaded value:`,l.value)}catch(d){L("useLocalStorage",`Error parsing "${t}":`,d)}else n("useLocalStorage",`"${t}" using initial value`);M(l,(d,m)=>{n("useLocalStorage",`"${t}" WATCH triggered!`,{newValue:d,oldValue:m});try{window.localStorage.setItem(t,JSON.stringify(d)),n("useLocalStorage",`"${t}" saved successfully`)}catch(_){L("useLocalStorage",`Error saving "${t}":`,_)}},{deep:!0,immediate:!1})}return l}const k="students",J="assignmentHistory",W={enero:0,febrero:1,marzo:2,abril:3,mayo:4,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11};function S(t){const s=t.toLowerCase().match(/(\d+)-\d+\s+de\s+(\w+)/);if(!s||!s[1]||!s[2])return 0;const l=parseInt(s[1]),g=s[2].toLowerCase(),d=W[g];if(d===void 0)return 0;const m=new Date().getFullYear();return new Date(m,d,l).getTime()}let A=null,D=null,h=!1;function E(){n("useStudents","Initializing global state..."),A||(n("useStudents","Creating globalStudents ref"),A=y(k,[])),D||(n("useStudents","Creating globalAssignmentHistory ref"),D=y(J,[])),h=!0,n("useStudents","Global state initialized")}function q(){const t=v(!1);n("useStudents","useStudents() called, initialized:",h,"client:",!0),O(()=>{n("useStudents","onMounted triggered"),Y(()=>{n("useStudents","nextTick callback, initialized:",h),h||E(),t.value=!0,n("useStudents","Ready state set to true")})}),h||(n("useStudents","Immediate client-side initialization"),E(),t.value=!0);const s=A??v([]),l=D??v([]);n("useStudents","Refs assigned:",{students:!!A,assignmentHistory:!!D});function g(a,r){const i={id:w(),name:a.trim(),gender:r,hidden:!1};return s.value.push(i),i}function d(a){const r=s.value.find(i=>i.id===a);r&&(r.hidden=!r.hidden)}function m(a,r){const i=l.value.filter(e=>(e.studentId===a||e.companionId===a)&&e.assignmentType===r).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function _(a,r){const i=l.value.filter(e=>e.studentId===a&&e.companionId===r||e.studentId===r&&e.companionId===a).sort((e,c)=>c.createdAt-e.createdAt);return i.length>0?i[0]?.weekDate??null:null}function I(a,r){return s.value.filter(e=>!e.hidden).map(e=>({...e,lastAssignmentDate:m(e.id,a)})).sort((e,c)=>{if(!e.lastAssignmentDate&&!c.lastAssignmentDate)return 0;if(!e.lastAssignmentDate)return-1;if(!c.lastAssignmentDate)return 1;const p=S(e.lastAssignmentDate),o=S(c.lastAssignmentDate);return p-o})}function $(a,r,i){const e=s.value.find(o=>o.id===a);if(!e)return[];const c=e.gender;return s.value.filter(o=>!o.hidden&&o.id!==a&&o.gender===c).map(o=>({...o,lastTimeTogether:_(a,o.id),lastAssignmentDate:m(o.id,i)})).sort((o,f)=>{let u=0;if(!o.lastTimeTogether&&!f.lastTimeTogether)u=0;else if(!o.lastTimeTogether)u=-1;else if(!f.lastTimeTogether)u=1;else{const T=S(o.lastTimeTogether),b=S(f.lastTimeTogether);u=T-b}if(u===0)if(!o.lastAssignmentDate&&!f.lastAssignmentDate)u=0;else if(!o.lastAssignmentDate)u=-1;else if(!f.lastAssignmentDate)u=1;else{const T=S(o.lastAssignmentDate),b=S(f.lastAssignmentDate);u=T-b}return u})}function N(a){n("useStudents","assignStudent() called:",a),n("useStudents","assignmentHistory ref:",l),n("useStudents","assignmentHistory.value before:",l.value.length);const r={...a,id:w(),createdAt:Date.now()};n("useStudents","Creating new record:",r);const i=[...l.value,r];n("useStudents","New array length:",i.length),l.value=i,n("useStudents","assignmentHistory.value after:",l.value.length)}function z(a){return s.value.find(i=>i.id===a)?.name||""}return{students:s,assignmentHistory:l,ready:t,addStudent:g,toggleStudentHidden:d,getStudentsSortedByLastAssignment:I,getCompanionsSorted:$,assignStudent:N,getStudentName:z,getLastAssignmentDate:m}}export{X as _,y as a,q as u};
